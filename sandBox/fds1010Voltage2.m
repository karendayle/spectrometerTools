% plot output voltage after photodiode vs supplied laser diode power
% use 3 different load resistors
% data from notebook 2021/06/08
% for 20210614 SR
close all;

blue =    [0.0000, 0.4470, 0.7410];
rust =    [0.8500, 0.3250, 0.0980];
gold =    [0.9290, 0.6940, 0.1250];
purple =  [0.4940, 0.1840, 0.5560];
green =   [0.4660, 0.6740, 0.1880];
ciel =    [0.3010, 0.7450, 0.9330];
cherry =  [0.6350, 0.0780, 0.1840];
red =     [1.0, 0.0, 0.0];
black =   [0.0, 0.0, 0.0];
magenta = [1.0, 0.0, 1.0];
myTextFont = 30;

% Vin, Vout, Iout, (Iout*R_L) using R_L = 10 kohm. 
R_L = 10.e3;
data1 = [ 0.0, 0.2, 0.02, (0.02e-3*R_L); ...
    1.0, 0.18, 0.02, (0.02e-3*R_L); 2.0, 0.15, 0.01, (0.01e-3*R_L); ...
    2.5, 0.17, 0.01, (0.01e-3*R_L); 3.0, 8.77, 0.147, (0.147e-3*R_L); ...
    3.5, 8.82, 2.5, (2.5e-3*R_L); ...
    4.0, 8.85, 3.9, (3.9e-3*R_L); 4.5, 8.86, 5.6, (5.6e-3*R_L); ...
    5.0, 8.83, 5.3, (5.3e-3*R_L); 5.5, 8.87, 4.8, (4.8e-3*R_L); ...
    6.0, 8.86, 5.2, (5.2e-3*R_L) ];

% Vin, Vout, Iout, (Iout*R_L) using R_L = 100 kohm. Trial 1.
R_L = 100.e3;
data2 = [ 0.0, 2.1, 0.01, (0.01e-3*R_L); 1.0, 1.8, 0.01, (0.01e-3*R_L); ...
    2.0, 1.8, 0.01, (0.01e-3*R_L); ...
    2.5, 1.8, 0.01, (0.01e-3*R_L); 3.0, 9.69, 1.3, (1.3e-3*R_L); ...
    3.5, 9.72, 2.15, (2.15e-3*R_L); ...
    4.0, 9.75, 4.5, (4.5e-3*R_L); 4.5, 9.77, 6.5, (6.5e-3*R_L); ...
    5.0, 9.78, 6.0, (6.e-3*R_L); 5.5, 9.76, 5.15, (5.15e-3*R_L); ...
    6.0, 9.75, 5.6, (5.6e-3*R_L) ];

% Vin, Vout, Iout, (Iout*R_L) using R_L = 100 kohm. Trial 2.
R_L = 100.e3; % it is already, but for clarity
data3 = [ 0.0, 4.8, 0.05, (0.05e-3*R_L); 1.0, 4.3, 0.04, (0.04e-3*R_L); ...
    2.0, 4.3, 0.04, (0.04e-3*R_L); ...
    2.5, 4.5, 0.04, (0.04e-3*R_L); 3.0, 9.67, 1.03, (1.03e-3*R_L); ...
    3.5, 9.71, 2.4, (2.4e-3*R_L); ...
    4.0, 9.73, 3.7, (3.7e-3*R_L); 4.5, 9.74, 5.6, (5.6e-3*R_L); ...
    5.0, 9.74, 5.5, (5.5e-3*R_L); ...
    5.5, 9.74, 5.7, (5.7e-3*R_L); 6.0, 9.74, 5.8, (5.8e-3*R_L) ];

% Vin, Vout, Iout, (Iout*R_L) using R_L = 1 Mohm
R_L = 1.e6;
data4 = [ 0.0, 9.62, 0.01, (0.01e-3*R_L); ...
    1.0, 9.67, 0.01, (0.01e-3*R_L); 2.0, 9.59, 0.01, (0.01e-3*R_L); ...
    2.5, 9.63, 0.02, (0.02e-3*R_L); 3.0, 9.77, 0.7, (0.7e-3*R_L); ...
    3.5, 9.79, 2.65, (2.65e-3*R_L); ...
    4.0, 9.82, 5.12, (5.12e-3*R_L); 4.5, 9.82, 5.6, (5.6e-3*R_L); ...
    5.0, 9.84, 4.8, (4.8e-3*R_L); 5.5, 9.79, 5.3, (5.3e-3*R_L); ...
    6.0, 9.8, 5., (5.e-3*R_L) ];

figure
% Vout
plot(data1(:,1), data1(:,2),'-o','MarkerSize',10,...
    'MarkerEdgeColor',red,...
    'MarkerFaceColor',[1 .6 .6]);
hold on
plot(data2(:,1), data2(:,2),'-s','MarkerSize',10,...
    'MarkerEdgeColor',blue,...
    'MarkerFaceColor',[.6 .6  1]);
hold on
plot(data3(:,1), data3(:,2),'-^','MarkerSize',10,...
    'MarkerEdgeColor',green,...
    'MarkerFaceColor',[.6 1 .6]);
hold on
plot(data4(:,1), data4(:,2),'-v','MarkerSize',10,...
    'MarkerEdgeColor',purple,...
    'MarkerFaceColor',purple);
set(gca,'FontSize', myTextFont); % has no effect on tick label size
title('Measured Vout vs supplied laser diode voltage');
xlabel('Voltage supplied to laser diode (V)'); % x-axis label
ylabel('Vout (V)'); % y-axis label
legend('R_L = 10 kohm','R_L = 100 kohm 1','R_L = 100 kohm 2', ...
    'R_L = 1 Mohm','Location','southeast');

% Iout
figure
plot(data1(:,1), data1(:,3),'-o','MarkerSize',10,...
    'MarkerEdgeColor',red,...
    'MarkerFaceColor',[1 .6 .6]);
hold on
plot(data2(:,1), data2(:,3),'-s','MarkerSize',10,...
    'MarkerEdgeColor',blue,...
    'MarkerFaceColor',[.6 .6 1]);
hold on
plot(data3(:,1), data3(:,3),'-^','MarkerSize',10,...
    'MarkerEdgeColor',green,...
    'MarkerFaceColor',[.6 1 .6]);
hold on
plot(data4(:,1), data4(:,3),'-v','MarkerSize',10,...
    'MarkerEdgeColor',purple,...
    'MarkerFaceColor',purple);
set(gca,'FontSize', myTextFont)
set(gca,'FontSize', myTextFont); % has no effect on tick label size
title('Measured output current vs supplied laser diode voltage');
xlabel('Voltage supplied to laser diode (V)'); % x-axis label
ylabel('I_o_u_t (mA)'); % y-axis label
legend('R_L = 10 kohm','R_L = 100 kohm 1','R_L = 100 kohm 2', ...
    'R_L = 1 Mohm','Location','southeast');

% Iout * R_L
figure
plot(data1(:,1), data1(:,4),'-o','MarkerSize',10,...
    'MarkerEdgeColor',red,...
    'MarkerFaceColor',[1 .6 .6]);
hold on
plot(data2(:,1), data2(:,4),'-s','MarkerSize',10,...
    'MarkerEdgeColor',blue,...
    'MarkerFaceColor',[.6 .6 1]);
hold on
plot(data3(:,1), data3(:,4),'-^','MarkerSize',10,...
    'MarkerEdgeColor',green,...
    'MarkerFaceColor',[.6 1 .6]);
hold on
plot(data4(:,1), data4(:,4),'-v','MarkerSize',10,...
    'MarkerEdgeColor',purple,...
    'MarkerFaceColor',purple);
set(gca,'FontSize', myTextFont); % has no effect on tick label size
title('Measured output current * load resistor vs supplied laser diode voltage, with V_RB = 9V');
xlabel('Voltage supplied to laser diode (V)'); % x-axis label
ylabel('I_o_u_t * R_L (V)'); % y-axis label
legend('R_L = 10 kohm','R_L = 100 kohm 1','R_L = 100 kohm 2', ...
    'R_L = 1 Mohm','Location','southeast');


function g = saveMyPlot(FigH, myTitle)
global plotOption
    dirStem = "C:\Users\karen\Documents\Data\";
    subDir = "Plots\";
    plotDirStem = sprintf("%s%s", dirStem, subDir);
    switch plotOption
        case {1,2,3}
            myPlotName = sprintf('%s%s', plotDirStem, myTitle);
        case 4
            myPlotName = sprintf('%s%s curve fit', plotDirStem, myTitle);
    end
    saveas(FigH, myPlotName, 'png');
    g = 1;
end